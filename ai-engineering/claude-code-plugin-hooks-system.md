---
created: 2026-02-20
source: claude-code
tags: []
---

# ğŸ“– Claude Code Plugin Hooks System â€” Concept Deep Dive

> ğŸ’¡ **í•œì¤„ ìš”ì•½**: Claude Codeì˜ **Hook ì‹œìŠ¤í…œ**ì€ ì„¸ì…˜ ë¼ì´í”„ì‚¬ì´í´ì˜ íŠ¹ì • ì‹œì ì— ìë™ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” ì…¸ ì»¤ë§¨ë“œ/í”„ë¡¬í”„íŠ¸/ì—ì´ì „íŠ¸ë¡œ, í”ŒëŸ¬ê·¸ì¸ì€ `hooks/hooks.json`ê³¼ ì…¸ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ ì´ë¥¼ í™œìš©í•œë‹¤.

---

## 1ï¸âƒ£ ë¬´ì—‡ì¸ê°€? (What is it?)

Claude Codeì˜ **Hook**ì€ ì„¸ì…˜ ë¼ì´í”„ì‚¬ì´í´ì˜ íŠ¹ì • ì´ë²¤íŠ¸(ì‹œì‘, ë„êµ¬ ì‹¤í–‰ ì „í›„, ì¢…ë£Œ ë“±)ì— ìë™ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” **ì‚¬ìš©ì ì •ì˜ í•¸ë“¤ëŸ¬**ì´ë‹¤. 2025~2026ë…„ ì´ˆì— ë„ì…ë˜ì—ˆìœ¼ë©°, Claude Codeê°€ ë‹¨ìˆœí•œ AI ì½”ë”© ì–´ì‹œìŠ¤í„´íŠ¸ë¥¼ ë„˜ì–´ **í”„ë¡œê·¸ë˜ë¨¸ë¸”í•œ ì—ì´ì „íŠ¸ í”Œë«í¼**ìœ¼ë¡œ ì§„í™”í•˜ëŠ” í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜ì´ë‹¤.

`452c38756951/hooks/` ë””ë ‰í† ë¦¬ëŠ” ralph-loop í”ŒëŸ¬ê·¸ì¸ì´ ì´ Hook ì‹œìŠ¤í…œì„ í™œìš©í•˜ëŠ” êµ¬ì²´ì  ì‚¬ë¡€ë¡œ:

- **`hooks.json`** â€” Hook ë“±ë¡ ì„¤ì • (ì–´ë–¤ ì´ë²¤íŠ¸ì— ì–´ë–¤ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì—°ê²°í• ì§€)
- **`stop-hook.sh`** â€” ì‹¤ì œ ë¡œì§ì´ ë‹´ê¸´ ì…¸ ìŠ¤í¬ë¦½íŠ¸ (ì¢…ë£Œë¥¼ ì°¨ë‹¨í•˜ê³  ë£¨í”„ë¥¼ ì§€ì†)

> ğŸ“Œ **í•µì‹¬ í‚¤ì›Œë“œ**: `Hook Event`, `Stop Hook`, `decision: block`, `stdin JSON`, `exit code`

---

## 2ï¸âƒ£ í•µì‹¬ ê°œë… (Core Concepts)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Claude Code Hook System                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Hook Event   â”‚â”€â”€â”€â–¶â”‚ Matcher Group â”‚â”€â”€â”€â–¶â”‚ Hook Handler â”‚  â”‚
â”‚  â”‚ (When?)       â”‚    â”‚ (Filter?)     â”‚    â”‚ (What?)      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  Events:              Matchers:           Handler Types:    â”‚
â”‚  Â· SessionStart       Â· Tool name         Â· command (sh)   â”‚
â”‚  Â· PreToolUse         Â· Notification type  Â· prompt (LLM)  â”‚
â”‚  Â· PostToolUse        Â· Agent type         Â· agent (Multi) â”‚
â”‚  Â· Stop â—€â”€â”€ í•µì‹¬      Â· (regex ì§€ì›)                        â”‚
â”‚  Â· SubagentStop                                             â”‚
â”‚  Â· SessionEnd                                               â”‚
â”‚  Â· ê·¸ ì™¸ 8ê°œ                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| êµ¬ì„± ìš”ì†Œ        | ì—­í•         | ì„¤ëª…                                                          |
| ---------------- | ----------- | ------------------------------------------------------------- |
| **Hook Event**   | íŠ¸ë¦¬ê±° ì‹œì  | 14ê°œ ë¼ì´í”„ì‚¬ì´í´ ì´ë²¤íŠ¸ (`Stop`, `PreToolUse` ë“±)            |
| **Matcher Group** | í•„í„°ë§      | regexë¡œ íŠ¹ì • ë„êµ¬/ì´ë²¤íŠ¸ íƒ€ì…ë§Œ ë§¤ì¹­ (Stopì€ ë§¤ì²˜ ë¯¸ì§€ì›)     |
| **Hook Handler** | ì‹¤í–‰ ë³¸ì²´   | `command`(ì…¸), `prompt`(LLM 1íšŒ), `agent`(ë„êµ¬ ì‚¬ìš© ê°€ëŠ¥ LLM) |
| **stdin JSON**   | ì…ë ¥        | Claude Codeê°€ ì´ë²¤íŠ¸ ì»¨í…ìŠ¤íŠ¸ë¥¼ JSONìœ¼ë¡œ ì „ë‹¬                 |
| **stdout JSON / exit code** | ì¶œë ¥ | í•¸ë“¤ëŸ¬ê°€ ê²°ì •(allow/block)ì„ ë°˜í™˜                        |

---

## 3ï¸âƒ£ ì•„í‚¤í…ì²˜ì™€ ë™ì‘ ì›ë¦¬ (Architecture & How it Works)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Claude Code Runtime                           â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ Claude   â”‚â”€â”€â”€â”€â–¶â”‚ Stop     â”‚â”€â”€â”€â”€â–¶â”‚ hooks.json  â”‚              â”‚
â”‚  â”‚ ì‘ë‹µ ì™„ë£Œ â”‚     â”‚ Event    â”‚     â”‚ ë§¤ì¹­ í™•ì¸    â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                          â”‚                      â”‚
â”‚                                          â–¼                      â”‚
â”‚                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚                              stdinâ”‚ stop-hook.sh  â”‚stdout       â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                  â”‚  {              â”‚  1. ìƒíƒœ í™•ì¸  â”‚          â”‚   â”‚
â”‚                  â”‚   session_id,  â”‚  2. iteration â”‚          â”‚   â”‚
â”‚                  â”‚   transcript,  â”‚  3. promise?  â”‚          â”‚   â”‚
â”‚                  â”‚   cwd,         â”‚  4. íŒë‹¨      â”‚          â”‚   â”‚
â”‚                  â”‚   stop_hook_   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   â”‚
â”‚                  â”‚    active,                                â”‚   â”‚
â”‚                  â”‚   last_assistant                          â”‚   â”‚
â”‚                  â”‚    _message                               â”‚   â”‚
â”‚                  â”‚  }                                        â”‚   â”‚
â”‚                  â”‚                                           â–¼   â”‚
â”‚                  â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚                  â”‚              â”‚ exit 0 (ì¢…ë£Œ í—ˆìš©)             â”‚â”‚
â”‚                  â”‚              â”‚   OR                          â”‚â”‚
â”‚                  â”‚              â”‚ {"decision":"block",          â”‚â”‚
â”‚                  â”‚              â”‚  "reason":"ì›ë³¸ í”„ë¡¬í”„íŠ¸",      â”‚â”‚
â”‚                  â”‚              â”‚  "systemMessage":"ğŸ”„ iter N"} â”‚â”‚
â”‚                  â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                  â”‚                         â”‚                     â”‚
â”‚                  â”‚                         â–¼                     â”‚
â”‚                  â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚                  â”‚              â”‚ block â†’ Claudeì—ê²Œ  â”‚            â”‚
â”‚                  â”‚              â”‚ reasonì„ ìƒˆ í”„ë¡¬í”„íŠ¸ â”‚            â”‚
â”‚                  â”‚              â”‚ ë¡œ ì „ë‹¬, ê³„ì† ì‘ì—…   â”‚            â”‚
â”‚                  â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”„ ë™ì‘ íë¦„ (Step by Step) â€” ralph-loopì˜ `hooks/` ê¸°ì¤€

1. **`hooks.json` ë“±ë¡**: í”ŒëŸ¬ê·¸ì¸ í™œì„±í™” ì‹œ `Stop` ì´ë²¤íŠ¸ì— `stop-hook.sh`ê°€ ë“±ë¡ë¨
2. **Claude ì‘ë‹µ ì™„ë£Œ**: Claudeê°€ ì‘ì—…ì„ ëë‚´ë©´ `Stop` ì´ë²¤íŠ¸ ë°œìƒ
3. **stdinìœ¼ë¡œ JSON ì „ë‹¬**: `session_id`, `transcript_path`, `stop_hook_active`, `last_assistant_message` ë“±
4. **stop-hook.sh ì‹¤í–‰**:
   - `.claude/ralph-loop.local.md` ìƒíƒœ íŒŒì¼ í™•ì¸
   - `iteration` / `max_iterations` íŒŒì‹±
   - transcriptì—ì„œ ë§ˆì§€ë§‰ assistant ë©”ì‹œì§€ ì¶”ì¶œ
   - `<promise>` íƒœê·¸ë¡œ completion promise ê²€ì‚¬
5. **ê²°ì • ë°˜í™˜**:
   - ë£¨í”„ ì¢…ë£Œ ì¡°ê±´ ì¶©ì¡± â†’ `exit 0` (ì¢…ë£Œ í—ˆìš©)
   - ê³„ì† ë°˜ë³µ â†’ `{"decision": "block", "reason": "ì›ë³¸ í”„ë¡¬í”„íŠ¸"}` (ì¢…ë£Œ ì°¨ë‹¨)
6. **Claude Codeê°€ reasonì„ ìƒˆ í”„ë¡¬í”„íŠ¸ë¡œ ì£¼ì…** â†’ Claudeê°€ ë‹¤ì‹œ ì‘ì—… ì‹œì‘

---

## 4ï¸âƒ£ ìœ ì¦ˆ ì¼€ì´ìŠ¤ & ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤ (Use Cases & Best Practices)

### ğŸ¯ ëŒ€í‘œ ìœ ì¦ˆ ì¼€ì´ìŠ¤

| #   | ìœ ì¦ˆ ì¼€ì´ìŠ¤                      | ì„¤ëª…                                         | ê´€ë ¨ ì´ë²¤íŠ¸ |
| --- | -------------------------------- | -------------------------------------------- | ----------- |
| 1   | **ìê¸° ì°¸ì¡° ë£¨í”„ (Ralph Loop)**  | ê°™ì€ í”„ë¡¬í”„íŠ¸ë¥¼ ë°˜ë³µ ì£¼ì…í•˜ì—¬ ììœ¨ ê°œì„        | `Stop`      |
| 2   | **ìœ„í—˜ ëª…ë ¹ ì°¨ë‹¨**               | `rm -rf` ë“± íŒŒê´´ì  ëª…ë ¹ ì‚¬ì „ ì°¨ë‹¨            | `PreToolUse` |
| 3   | **ìë™ ë¦°íŠ¸/í¬ë§·**               | íŒŒì¼ ìˆ˜ì • í›„ ìë™ìœ¼ë¡œ ë¦°í„° ì‹¤í–‰              | `PostToolUse` |
| 4   | **í™˜ê²½ ë³€ìˆ˜ ì£¼ì…**               | ì„¸ì…˜ ì‹œì‘ ì‹œ ê°œë°œ í™˜ê²½ ì„¤ì • ë¡œë“œ             | `SessionStart` |
| 5   | **í’ˆì§ˆ ê²Œì´íŠ¸**                  | í…ŒìŠ¤íŠ¸ í†µê³¼ ì „ê¹Œì§€ ì‘ì—… ì™„ë£Œ ì°¨ë‹¨            | `TaskCompleted` |

### âœ… ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤

1. **`stop_hook_active` í™•ì¸**: Stop hookì—ì„œ ë¬´í•œ ë£¨í”„ ë°©ì§€ë¥¼ ìœ„í•´ ë°˜ë“œì‹œ ì²´í¬
2. **exit code ê·œì¹™ ì¤€ìˆ˜**: `0` = í—ˆìš©, `2` = ì°¨ë‹¨, ê¸°íƒ€ = ë¹„ì°¨ë‹¨ ì˜¤ë¥˜
3. **JSONê³¼ exit code í˜¼ìš© ê¸ˆì§€**: exit 0 + JSON ë˜ëŠ” exit 2 + stderr ì¤‘ í•˜ë‚˜ë§Œ ì‚¬ìš©
4. **`$CLAUDE_PLUGIN_ROOT` ì‚¬ìš©**: í”ŒëŸ¬ê·¸ì¸ ë‚´ ìŠ¤í¬ë¦½íŠ¸ ì°¸ì¡° ì‹œ ìƒëŒ€ê²½ë¡œ ëŒ€ì‹  í™˜ê²½ë³€ìˆ˜ ì‚¬ìš©

### ğŸ¢ ì‹¤ì œ ì ìš© ì‚¬ë¡€

- **ralph-loop í”ŒëŸ¬ê·¸ì¸**: Stop hookìœ¼ë¡œ ìê¸° ì°¸ì¡° ê°œë°œ ë£¨í”„ êµ¬í˜„
- **security-guidance í”ŒëŸ¬ê·¸ì¸**: PreToolUse hookìœ¼ë¡œ ë³´ì•ˆ ê²€ì‚¬ ìë™í™”
- **hookify í”ŒëŸ¬ê·¸ì¸**: hook ìƒì„±/ê´€ë¦¬ë¥¼ ìë™í™”í•˜ëŠ” ë©”íƒ€ í”ŒëŸ¬ê·¸ì¸

---

## 5ï¸âƒ£ ì¥ì ê³¼ ë‹¨ì  (Pros & Cons)

| êµ¬ë¶„      | í•­ëª©                      | ì„¤ëª…                                                                                                                    |
| --------- | ------------------------- | ----------------------------------------------------------------------------------------------------------------------- |
| âœ… ì¥ì    | **ì‹œìŠ¤í…œ ë ˆë²¨ ì œì–´**      | Claude(AI)ì˜ íŒë‹¨ê³¼ ë…ë¦½ì ìœ¼ë¡œ ë™ì‘                                                                                     |
| âœ… ì¥ì    | **3ê°€ì§€ í•¸ë“¤ëŸ¬ íƒ€ì…**     | command/prompt/agentë¡œ ìœ ì—°í•œ êµ¬í˜„                                                                                       |
| âœ… ì¥ì    | **14ê°œ ì´ë²¤íŠ¸ í¬ì¸íŠ¸**    | ë¼ì´í”„ì‚¬ì´í´ ì „ì²´ë¥¼ ì»¤ë²„í•˜ëŠ” ì„¸ë°€í•œ ì œì–´                                                                                 |
| âœ… ì¥ì    | **ë¹„ë™ê¸° ì§€ì›**           | `async: true`ë¡œ ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰ ê°€ëŠ¥                                                                                     |
| âŒ ë‹¨ì    | **ë””ë²„ê¹… ë‚œì´ë„**         | stdin/stdout JSON ê¸°ë°˜ì´ë¼ ë””ë²„ê¹…ì´ ê¹Œë‹¤ë¡œì›€                                                                             |
| âŒ ë‹¨ì    | **ë³´ì•ˆ ë¦¬ìŠ¤í¬**           | ì‚¬ìš©ì ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰ë˜ë¯€ë¡œ ì‹ ë¢°í•  ìˆ˜ ì—†ëŠ” ìŠ¤í¬ë¦½íŠ¸ ìœ„í—˜                                                                  |
| âŒ ë‹¨ì    | **í”ŒëŸ¬ê·¸ì¸ í˜¸í™˜ì„± ì´ìŠˆ**  | exit code 2ê°€ í”ŒëŸ¬ê·¸ì¸ ê²½ìœ  ì‹œ ë™ì‘ì´ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ ([ì´ìŠˆ #10412](https://github.com/anthropics/claude-code/issues/10412)) |

### âš–ï¸ Trade-off ë¶„ì„

```
ê°•ë ¥í•œ ì œì–´     â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  ë³´ì•ˆ ë¦¬ìŠ¤í¬ ì¦ê°€
ìœ ì—°í•œ í•¸ë“¤ëŸ¬    â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  ì„¤ì • ë³µì¡ë„ ì¦ê°€
ì‹œìŠ¤í…œ ë…ë¦½ ì‹¤í–‰ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  ë””ë²„ê¹… ì–´ë ¤ì›€
```

---

## 6ï¸âƒ£ ì°¨ì´ì  ë¹„êµ (Comparison)

### ğŸ“Š ë¹„êµ ë§¤íŠ¸ë¦­ìŠ¤: Hook ì •ì˜ ìœ„ì¹˜ë³„ ì°¨ì´

| ë¹„êµ ê¸°ì¤€              | Plugin `hooks/hooks.json`    | User `settings.json` | Skill/Agent frontmatter  |
| ---------------------- | ---------------------------- | -------------------- | ------------------------ |
| ë²”ìœ„                   | í”ŒëŸ¬ê·¸ì¸ í™œì„±í™” ì‹œ           | ì „ì—­/í”„ë¡œì íŠ¸        | ì»´í¬ë„ŒíŠ¸ í™œì„± ì‹œ         |
| ê³µìœ  ê°€ëŠ¥              | âœ… í”ŒëŸ¬ê·¸ì¸ê³¼ í•¨ê»˜ ë°°í¬       | âŒ ë¡œì»¬ ë¨¸ì‹           | âœ… íŒŒì¼ì— í¬í•¨            |
| í¸ì§‘                   | ì½ê¸° ì „ìš© (í”ŒëŸ¬ê·¸ì¸ ê´€ë¦¬)    | `/hooks` ë©”ë‰´        | íŒŒì¼ ì§ì ‘ í¸ì§‘           |
| `CLAUDE_PLUGIN_ROOT`   | âœ… ì‚¬ìš© ê°€ëŠ¥                  | âŒ                    | âŒ                        |
| ìˆ˜ëª…                   | í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜~ì œê±°           | ì˜êµ¬                 | ìŠ¤í‚¬/ì—ì´ì „íŠ¸ ì‹¤í–‰ ë™ì•ˆ  |

### ğŸ” í•µì‹¬ ì°¨ì´: 3ê°€ì§€ Hook Handler íƒ€ì…

```
command (ì…¸)              prompt (LLM 1íšŒ)           agent (LLM + ë„êµ¬)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ê²°ì •ë¡ ì  ì‹¤í–‰            ì˜ë¯¸ ê¸°ë°˜ íŒë‹¨             ì‹¬í™” ê²€ì¦ ê°€ëŠ¥
ë¹ ë¦„ (ms ë‹¨ìœ„)           ì¤‘ê°„ (ìˆ˜ì´ˆ)                ëŠë¦¼ (ìˆ˜ì‹­ì´ˆ)
íŒŒì¼/í”„ë¡œì„¸ìŠ¤ ì¡°ì‘        ìì—°ì–´ í‰ê°€               ì½”ë“œ ì½ê¸°/ê²€ìƒ‰
exit code + JSON         ok: true/false           ok: true/false
```

### ğŸ¤” ì–¸ì œ ë¬´ì—‡ì„ ì„ íƒ?

- **command** â†’ ì •í™•í•œ íŒ¨í„´ ë§¤ì¹­, íŒŒì¼ ì¡°ì‘, ìƒíƒœ ê´€ë¦¬ (ralph-loopì²˜ëŸ¼)
- **prompt** â†’ "ì´ ì½”ë“œê°€ ì•ˆì „í•œê°€?" ê°™ì€ ì˜ë¯¸ì  íŒë‹¨
- **agent** â†’ "í…ŒìŠ¤íŠ¸ê°€ í†µê³¼í•˜ëŠ”ì§€ ì‹¤ì œë¡œ í™•ì¸í•´ë¼" ê°™ì€ ë³µí•© ê²€ì¦

---

## 7ï¸âƒ£ ì‚¬ìš© ì‹œ ì£¼ì˜ì  (Pitfalls & Cautions)

### âš ï¸ í”í•œ ì‹¤ìˆ˜ (Common Mistakes)

| #   | ì‹¤ìˆ˜                                       | ì™œ ë¬¸ì œì¸ê°€                       | ì˜¬ë°”ë¥¸ ì ‘ê·¼                               |
| --- | ------------------------------------------ | --------------------------------- | ----------------------------------------- |
| 1   | Stop hookì—ì„œ `stop_hook_active` ë¯¸í™•ì¸    | ë¬´í•œ ë£¨í”„ ë°œìƒ                    | ë°˜ë“œì‹œ ì²´í¬í•˜ê±°ë‚˜ max_iterations ì„¤ì •     |
| 2   | exit 2 + JSON ë™ì‹œ ì‚¬ìš©                    | exit 2ì¼ ë•Œ JSONì€ ë¬´ì‹œë¨        | í•œ ê°€ì§€ ë°©ì‹ë§Œ ì„ íƒ                       |
| 3   | shell profileì´ stdoutì— í…ìŠ¤íŠ¸ ì¶œë ¥       | JSON íŒŒì‹± ì‹¤íŒ¨                    | ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ë¶ˆí•„ìš”í•œ ì¶œë ¥ ì œê±°           |
| 4   | ë³€ìˆ˜ ë”°ì˜´í‘œ ëˆ„ë½ (`$VAR` â†’ `"$VAR"`)      | ê²½ë¡œì— ê³µë°± ìˆìœ¼ë©´ ì˜¤ë¥˜           | í•­ìƒ `"$VAR"` ì‚¬ìš©                        |

### ğŸš« Anti-Patterns

1. **ë¬´í•œ Stop hook**: `stop_hook_active`ë¥¼ ì²´í¬í•˜ì§€ ì•Šìœ¼ë©´ Claudeê°€ ì˜ì›íˆ ì¢…ë£Œ ë¶ˆê°€ â†’ ralph-loopì€ `max_iterations`ë¡œ ì•ˆì „ì¥ì¹˜ êµ¬í˜„
2. **ì„¸ì…˜ ì¤‘ hooks íŒŒì¼ ìˆ˜ë™ ìˆ˜ì •**: Claude CodeëŠ” ì‹œì‘ ì‹œ ìŠ¤ëƒ…ìƒ·ì„ ì¡ìœ¼ë¯€ë¡œ ì„¸ì…˜ ì¤‘ ë³€ê²½ ì‹œ `/hooks` ë©”ë‰´ì—ì„œ ë¦¬ë·° í•„ìš”

### ğŸ”’ ë³´ì•ˆ/ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­

- Hookì€ **ì‚¬ìš©ì ê¶Œí•œ ì „ì²´**ë¡œ ì‹¤í–‰ë¨ â€” íŒŒì¼ ì‚­ì œ, ë„¤íŠ¸ì›Œí¬ ì ‘ê·¼ ëª¨ë‘ ê°€ëŠ¥
- í”ŒëŸ¬ê·¸ì¸ Hookì€ **ì½ê¸° ì „ìš©**ì´ì§€ë§Œ ì‹¤í–‰ë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ ìì²´ëŠ” ì œí•œ ì—†ìŒ
- `set -euo pipefail`ë¡œ ìŠ¤í¬ë¦½íŠ¸ ì•ˆì „ì„± í™•ë³´ (ralph-loopì˜ stop-hook.shê°€ ì¢‹ì€ ì˜ˆì‹œ)

---

## 8ï¸âƒ£ ê°œë°œìê°€ ì•Œì•„ë‘¬ì•¼ í•  ê²ƒë“¤ (Developer's Toolkit)

### ğŸ“š í•™ìŠµ ë¦¬ì†ŒìŠ¤

| ìœ í˜•      | ì´ë¦„              | ë§í¬/ì„¤ëª…                                                                                                |
| --------- | ----------------- | -------------------------------------------------------------------------------------------------------- |
| ğŸ“– ê³µì‹ ë¬¸ì„œ | Hooks reference   | [code.claude.com/docs/en/hooks](https://code.claude.com/docs/en/hooks)                                   |
| ğŸ“– ê³µì‹ ê°€ì´ë“œ | Hook Guide        | [docs.claude.com/en/docs/claude-code/hooks](https://docs.claude.com/en/docs/claude-code/hooks)           |
| ğŸ“– í”ŒëŸ¬ê·¸ì¸ ë¬¸ì„œ | Plugin README     | [github.com/anthropics/claude-code/plugins](https://github.com/anthropics/claude-code/blob/main/plugins/README.md) |
| ğŸ“˜ ì‹¤ì „ ì˜ˆì œ | hooks-mastery     | [github.com/disler/claude-code-hooks-mastery](https://github.com/disler/claude-code-hooks-mastery)       |
| ğŸ“º ë¸”ë¡œê·¸   | GitButler ê°€ì´ë“œ  | [blog.gitbutler.com](https://blog.gitbutler.com/automate-your-ai-workflows-with-claude-code-hooks/)     |

### ğŸ› ï¸ ê´€ë ¨ ë„êµ¬ & ë””ë²„ê¹…

| ë„êµ¬                     | ìš©ë„                                    |
| ------------------------ | --------------------------------------- |
| `claude --debug`         | Hook ì‹¤í–‰ ë¡œê·¸ í™•ì¸                     |
| `Ctrl+O` (verbose mode) | Hook stdout/stderr ì‹¤ì‹œê°„ í™•ì¸          |
| `/hooks` ë©”ë‰´            | Hook ë“±ë¡/ì‚­ì œ/ì¡°íšŒ ì¸í„°ë™í‹°ë¸Œ ê´€ë¦¬     |
| `jq`                     | stdin/stdout JSON íŒŒì‹± (stop-hook.shì—ì„œ ì‚¬ìš©) |

### ğŸ”® íŠ¸ë Œë“œ & ì „ë§

- **3-tier hook ì‹œìŠ¤í…œ** (command â†’ prompt â†’ agent)ìœ¼ë¡œ ì ì  ë” ì§€ëŠ¥ì ì¸ ìë™í™” ê°€ëŠ¥
- í”ŒëŸ¬ê·¸ì¸ ë§ˆì¼“í”Œë ˆì´ìŠ¤ í™•ì¥ìœ¼ë¡œ **Hook ê¸°ë°˜ í”ŒëŸ¬ê·¸ì¸ ìƒíƒœê³„** ì„±ì¥ ì¤‘
- `TeammateIdle`, `TaskCompleted` ë“± **ì—ì´ì „íŠ¸ íŒ€ ê´€ë ¨ Hook**ì´ ì¶”ê°€ë˜ë©°, ë©€í‹° ì—ì´ì „íŠ¸ ì›Œí¬í”Œë¡œìš° ì œì–´ë¡œ í™•ì¥ ì¤‘

---

## ğŸ“ Sources

1. [Hooks reference â€” Claude Code Docs](https://code.claude.com/docs/en/hooks) â€” ê³µì‹ ë¬¸ì„œ
2. [Plugin README â€” GitHub](https://github.com/anthropics/claude-code/blob/main/plugins/README.md) â€” ê³µì‹ ë¬¸ì„œ
3. [Stop hooks exit code 2 issue #10412](https://github.com/anthropics/claude-code/issues/10412) â€” ë²„ê·¸ ë¦¬í¬íŠ¸
4. [Claude Code Hook Control Flow â€” Steve Kinney](https://stevekinney.com/courses/ai-development/claude-code-hook-control-flow) â€” ë¸”ë¡œê·¸
5. [GitButler Hook Guide](https://blog.gitbutler.com/automate-your-ai-workflows-with-claude-code-hooks/) â€” ë¸”ë¡œê·¸
6. [Claude Code Hooks Mastery â€” GitHub](https://github.com/disler/claude-code-hooks-mastery) â€” ì‹¤ì „ ì˜ˆì œ
7. [Claude Code Hooks â€” DataCamp](https://www.datacamp.com/tutorial/claude-code-hooks) â€” íŠœí† ë¦¬ì–¼

---

> ğŸ”¬ **Research Metadata**
> - ê²€ìƒ‰ ì¿¼ë¦¬ ìˆ˜: 4
> - ìˆ˜ì§‘ ì¶œì²˜ ìˆ˜: 7
> - ì¶œì²˜ ìœ í˜•: ê³µì‹ 2, ë¸”ë¡œê·¸ 3, ì»¤ë®¤ë‹ˆí‹° 0, íŠœí† ë¦¬ì–¼ 2
